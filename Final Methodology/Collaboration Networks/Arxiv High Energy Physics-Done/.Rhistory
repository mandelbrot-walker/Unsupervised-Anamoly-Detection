bmp("tsne_model2_m3_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_2_m3$Y), col = ckm3$cluster)
dev.off()
p1 <- fviz_cluster(ckm3, geom = "point",  data = as.data.frame(tsne_model_2_m3$Y))
bmp("tsne_model2_m3_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m4
bmp("tsne_model2_m4_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_2_m4$Y), col = ckm4$cluster)
dev.off()
p1 <- fviz_cluster(ckm4, geom = "point",  data = as.data.frame(tsne_model_2_m4$Y))
bmp("tsne_model2_m4_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m5
bmp("tsne_model2_m5_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_2_m5$Y), col = ckm5$cluster)
dev.off()
p1 <- fviz_cluster(ckm5, geom = "point",  data = as.data.frame(tsne_model_2_m5$Y))
bmp("tsne_model2_m5_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m6
bmp("tsne_model2_m6_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_2_m6$Y), col = ckm6$cluster)
dev.off()
p1 <- fviz_cluster(ckm6, geom = "point",  data = as.data.frame(tsne_model_2_m6$Y))
bmp("tsne_model2_m6_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m7
bmp("tsne_model2_m7_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_2_m7$Y), col = ckm7$cluster)
dev.off()
p1 <- fviz_cluster(ckm7, geom = "point",  data = as.data.frame(tsne_model_2_m7$Y))
bmp("tsne_model2_m7_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m8
bmp("tsne_model2_m8_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_2_m8$Y), col = ckm8$cluster)
dev.off()
p1 <- fviz_cluster(ckm8, geom = "point",  data = as.data.frame(tsne_model_2_m8$Y))
bmp("tsne_model2_m8_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m9
bmp("tsne_model2_m9_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_2_m9$Y), col = ckm9$cluster)
dev.off()
p1 <- fviz_cluster(ckm9, geom = "point",  data = as.data.frame(tsne_model_2_m9$Y))
bmp("tsne_model2_m9_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#Kmeans for tsne model 3
bmp("tsne_model3_m1_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_3_m1$Y), col = ckm1$cluster)
dev.off()
p1 <- fviz_cluster(ckm1, geom = "point",  data = as.data.frame(tsne_model_3_m1$Y))
bmp("tsne_model3_m1_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m2
bmp("tsne_model3_m2_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_3_m2$Y), col = ckm2$cluster)
dev.off()
p1 <- fviz_cluster(ckm2, geom = "point",  data = as.data.frame(tsne_model_3_m2$Y))
bmp("tsne_model3_m2_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m3
bmp("tsne_model3_m3_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_3_m3$Y), col = ckm3$cluster)
dev.off()
p1 <- fviz_cluster(ckm3, geom = "point",  data = as.data.frame(tsne_model_3_m3$Y))
bmp("tsne_model3_m3_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m4
bmp("tsne_model3_m4_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_3_m4$Y), col = ckm4$cluster)
dev.off()
p1 <- fviz_cluster(ckm4, geom = "point",  data = as.data.frame(tsne_model_3_m4$Y))
bmp("tsne_model3_m4_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m5
bmp("tsne_model3_m5_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_3_m5$Y), col = ckm5$cluster)
dev.off()
p1 <- fviz_cluster(ckm5, geom = "point",  data = as.data.frame(tsne_model_3_m5$Y))
bmp("tsne_model3_m5_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m6
bmp("tsne_model3_m6_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_3_m6$Y), col = ckm6$cluster)
dev.off()
p1 <- fviz_cluster(ckm6, geom = "point",  data = as.data.frame(tsne_model_3_m6$Y))
bmp("tsne_model3_m6_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m7
bmp("tsne_model3_m7_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_3_m7$Y), col = ckm7$cluster)
dev.off()
p1 <- fviz_cluster(ckm7, geom = "point",  data = as.data.frame(tsne_model_3_m7$Y))
bmp("tsne_model3_m7_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m8
bmp("tsne_model3_m8_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_3_m8$Y), col = ckm8$cluster)
dev.off()
p1 <- fviz_cluster(ckm8, geom = "point",  data = as.data.frame(tsne_model_3_m8$Y))
bmp("tsne_model3_m8_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m9
bmp("tsne_model3_m9_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_3_m9$Y), col = ckm9$cluster)
dev.off()
p1 <- fviz_cluster(ckm9, geom = "point",  data = as.data.frame(tsne_model_3_m9$Y))
bmp("tsne_model3_m9_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#Kmeans for tsne model 4
bmp("tsne_model4_m1_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_4_m1$Y), col = ckm1$cluster)
dev.off()
p1 <- fviz_cluster(ckm1, geom = "point",  data = as.data.frame(tsne_model_4_m1$Y))
bmp("tsne_model4_m1_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m2
bmp("tsne_model4_m2_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_4_m2$Y), col = ckm2$cluster)
dev.off()
p1 <- fviz_cluster(ckm2, geom = "point",  data = as.data.frame(tsne_model_4_m2$Y))
bmp("tsne_model4_m2_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m3
bmp("tsne_model4_m3_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_4_m3$Y), col = ckm3$cluster)
dev.off()
p1 <- fviz_cluster(ckm3, geom = "point",  data = as.data.frame(tsne_model_4_m3$Y))
bmp("tsne_model4_m3_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m4
bmp("tsne_model4_m4_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_4_m4$Y), col = ckm4$cluster)
dev.off()
p1 <- fviz_cluster(ckm4, geom = "point",  data = as.data.frame(tsne_model_4_m4$Y))
bmp("tsne_model4_m4_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m5
bmp("tsne_model4_m5_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_4_m5$Y), col = ckm5$cluster)
dev.off()
p1 <- fviz_cluster(ckm5, geom = "point",  data = as.data.frame(tsne_model_4_m5$Y))
bmp("tsne_model4_m5_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m6
bmp("tsne_model4_m6_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_4_m6$Y), col = ckm6$cluster)
dev.off()
p1 <- fviz_cluster(ckm6, geom = "point",  data = as.data.frame(tsne_model_4_m6$Y))
bmp("tsne_model4_m6_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m7
bmp("tsne_model4_m7_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_4_m7$Y), col = ckm7$cluster)
dev.off()
p1 <- fviz_cluster(ckm7, geom = "point",  data = as.data.frame(tsne_model_4_m7$Y))
bmp("tsne_model4_m7_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m8
bmp("tsne_model4_m8_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_4_m8$Y), col = ckm8$cluster)
dev.off()
p1 <- fviz_cluster(ckm8, geom = "point",  data = as.data.frame(tsne_model_4_m8$Y))
bmp("tsne_model4_m8_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m9
bmp("tsne_model4_m9_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_4_m9$Y), col = ckm9$cluster)
dev.off()
p1 <- fviz_cluster(ckm9, geom = "point",  data = as.data.frame(tsne_model_4_m9$Y))
bmp("tsne_model4_m9_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
library(igraph)
library(centiserve)
library(tidyverse)
library(factoextra)
library(Rtsne)
library(Plasmidprofiler)
library(MASS)
library(data.table)
library(corrplot)
library(tibble)
library(caret)
library(plyr)
library(gridExtra)
library(CINNA)
library(ClusterR)
library(mclust)
library(kohonen)
library(kernlab)
library(Rdimtools)
library(scatterplot3d)
library(rgl)
library(fpc)
library(uwot)
ngb<-90
lr<-1.1
#  Umap m1
umap_calc <- umap(m1, n_neighbors = ngb, n_components = 2,metric = "cosine",
learning_rate = lr, scale = T, init = "spectral",
bandwidth = 30, negative_sample_rate = 20, n_trees = 50,
search_k = 2*90*50, pca_center = T, pcg_rand = T, ret_model = T,
ret_nn = T, n_threads = nthr, verbose = getOption("verbose",TRUE),
grain_size = 5,  min_dist = 10, spread = 50 )
umap_m1 <- data.frame(
UMAP1 = umap_calc$embedding[, 1],
UMAP2 = umap_calc$embedding[, 2]
)
bmp("umap_m1.bmp", width = 1920, height = 1280)
plot(umap_m1$UMAP1,umap_m1$UMAP2, col=factor(umap_m1$UMAP1))
dev.off()
bmp("umap_m1_km.bmp", width = 1920, height = 1280)
fviz_cluster(ckm1, geom = "point",  data = umap_m1)
dev.off()
#  Umap m2
umap_calc <- umap(m2, n_neighbors = ngb, n_components = 2,metric = "cosine",
learning_rate = lr, scale = T, init = "spectral",
bandwidth = 30, negative_sample_rate = 20, n_trees = 50,
search_k = 2*90*50, pca_center = T, pcg_rand = T, ret_model = T,
ret_nn = T, n_threads = nthr, verbose = getOption("verbose",TRUE),
grain_size = 5,  min_dist = 10, spread = 50 )
umap_m2 <- data.frame(
UMAP1 = umap_calc$embedding[, 1],
UMAP2 = umap_calc$embedding[, 2]
)
bmp("umap_m2.bmp", width = 1920, height = 1280)
plot(umap_m2$UMAP1,umap_m2$UMAP2, col=factor(umap_m2$UMAP1))
dev.off()
bmp("umap_m2_km.bmp", width = 1920, height = 1280)
fviz_cluster(ckm2, geom = "point",  data = umap_m2)
dev.off()
#  Umap m3
umap_calc <- umap(m3, n_neighbors = ngb, n_components = 2,metric = "cosine",
learning_rate = lr, scale = T, init = "spectral",
bandwidth = 30, negative_sample_rate = 20, n_trees = 50,
search_k = 2*90*50, pca_center = T, pcg_rand = T, ret_model = T,
ret_nn = T, n_threads = nthr, verbose = getOption("verbose",TRUE),
grain_size = 5,  min_dist = 10, spread = 50 )
umap_m3 <- data.frame(
UMAP1 = umap_calc$embedding[, 1],
UMAP2 = umap_calc$embedding[, 2]
)
bmp("umap_m3.bmp", width = 1920, height = 1280)
plot(umap_m3$UMAP1,umap_m3$UMAP2, col=factor(umap_m3$UMAP1))
dev.off()
bmp("umap_m3_km.bmp", width = 1920, height = 1280)
fviz_cluster(ckm3, geom = "point",  data = umap_m3)
dev.off()
#  Umap m4
umap_calc <- umap(m4, n_neighbors = ngb, n_components = 2,metric = "cosine",
learning_rate = lr, scale = T, init = "spectral",
bandwidth = 30, negative_sample_rate = 20, n_trees = 50,
search_k = 2*90*50, pca_center = T, pcg_rand = T, ret_model = T,
ret_nn = T, n_threads = nthr, verbose = getOption("verbose",TRUE),
grain_size = 5,  min_dist = 10, spread = 50 )
umap_m4 <- data.frame(
UMAP1 = umap_calc$embedding[, 1],
UMAP2 = umap_calc$embedding[, 2]
)
bmp("umap_m4.bmp", width = 1920, height = 1280)
plot(umap_m4$UMAP1,umap_m4$UMAP2, col=factor(umap_m4$UMAP1))
dev.off()
bmp("umap_m4_km.bmp", width = 1920, height = 1280)
fviz_cluster(ckm4, geom = "point",  data = umap_m4)
dev.off()
#  Umap m5
umap_calc <- umap(m5, n_neighbors = ngb, n_components = 2,metric = "cosine",
learning_rate = lr, scale = T, init = "spectral",
bandwidth = 30, negative_sample_rate = 20, n_trees = 50,
search_k = 2*90*50, pca_center = T, pcg_rand = T, ret_model = T,
ret_nn = T, n_threads = nthr, verbose = getOption("verbose",TRUE),
grain_size = 5,  min_dist = 10, spread = 50 )
umap_m5 <- data.frame(
UMAP1 = umap_calc$embedding[, 1],
UMAP2 = umap_calc$embedding[, 2]
)
bmp("umap_m5.bmp", width = 1920, height = 1280)
plot(umap_m5$UMAP1,umap_m5$UMAP2, col=factor(umap_m5$UMAP1))
dev.off()
bmp("umap_m5_km.bmp", width = 1920, height = 1280)
fviz_cluster(ckm5, geom = "point",  data = umap_m5)
dev.off()
#  Umap m6
umap_calc <- umap(m6, n_neighbors = ngb, n_components = 2,metric = "cosine",
learning_rate = lr, scale = T, init = "spectral",
bandwidth = 30, negative_sample_rate = 20, n_trees = 50,
search_k = 2*90*50, pca_center = T, pcg_rand = T, ret_model = T,
ret_nn = T, n_threads = nthr, verbose = getOption("verbose",TRUE),
grain_size = 5,  min_dist = 10, spread = 50 )
umap_m6 <- data.frame(
UMAP1 = umap_calc$embedding[, 1],
UMAP2 = umap_calc$embedding[, 2]
)
bmp("umap_m6.bmp", width = 1920, height = 1280)
plot(umap_m6$UMAP1,umap_m6$UMAP2, col=factor(umap_m6$UMAP1))
dev.off()
bmp("umap_m6_km.bmp", width = 1920, height = 1280)
fviz_cluster(ckm6, geom = "point",  data = umap_m6)
dev.off()
#  Umap m7
umap_calc <- umap(m7, n_neighbors = ngb, n_components = 2,metric = "cosine",
learning_rate = lr, scale = T, init = "spectral",
bandwidth = 30, negative_sample_rate = 20, n_trees = 50,
search_k = 2*90*50, pca_center = T, pcg_rand = T, ret_model = T,
ret_nn = T, n_threads = nthr, verbose = getOption("verbose",TRUE),
grain_size = 5,  min_dist = 10, spread = 50 )
umap_m7 <- data.frame(
UMAP1 = umap_calc$embedding[, 1],
UMAP2 = umap_calc$embedding[, 2]
)
bmp("umap_m7.bmp", width = 1920, height = 1280)
plot(umap_m7$UMAP1,umap_m7$UMAP2, col=factor(umap_m7$UMAP1))
dev.off()
bmp("umap_m7_km.bmp", width = 1920, height = 1280)
fviz_cluster(ckm7, geom = "point",  data = umap_m7)
dev.off()
#  Umap m8
umap_calc <- umap(m8, n_neighbors = ngb, n_components = 2,metric = "cosine",
learning_rate = lr, scale = T, init = "spectral",
bandwidth = 30, negative_sample_rate = 20, n_trees = 50,
search_k = 2*90*50, pca_center = T, pcg_rand = T, ret_model = T,
ret_nn = T, n_threads = nthr, verbose = getOption("verbose",TRUE),
grain_size = 5,  min_dist = 10, spread = 50 )
umap_m8 <- data.frame(
UMAP1 = umap_calc$embedding[, 1],
UMAP2 = umap_calc$embedding[, 2]
)
bmp("umap_m8.bmp", width = 1920, height = 1280)
plot(umap_m8$UMAP1,umap_m8$UMAP2, col=factor(umap_m8$UMAP1))
dev.off()
bmp("umap_m8_km.bmp", width = 1920, height = 1280)
fviz_cluster(ckm8, geom = "point",  data = umap_m8)
dev.off()
#  Umap m9
umap_calc <- umap(m9, n_neighbors = ngb, n_components = 2,metric = "cosine",
learning_rate = lr, scale = T, init = "spectral",
bandwidth = 30, negative_sample_rate = 20, n_trees = 50,
search_k = 2*90*50, pca_center = T, pcg_rand = T, ret_model = T,
ret_nn = T, n_threads = nthr, verbose = getOption("verbose",TRUE),
grain_size = 5,  min_dist = 10, spread = 50 )
umap_m9 <- data.frame(
UMAP1 = umap_calc$embedding[, 1],
UMAP2 = umap_calc$embedding[, 2]
)
bmp("umap_m9.bmp", width = 1920, height = 1280)
plot(umap_m9$UMAP1,umap_m9$UMAP2, col=factor(umap_m9$UMAP1))
dev.off()
bmp("umap_m9_km.bmp", width = 1920, height = 1280)
fviz_cluster(ckm9, geom = "point",  data = umap_m9)
dev.off()
rm(umap_calc)
#----------------Umap---------------------------#
#------------Sammon's map----------------#
x<-as.matrix(m1)
sammon = do.sammon(x, ndim=2, preprocess = c("center"), initialize = "pca")
bmp("sammon_m1.bmp", width = 1280, height = 720)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2))
plot(sammon$Y, pch=19, col=factor(ncen_tr$names), main="m1")
plot(sammon$Y, pch=19, col=ckm1$cluster, main="m1 k=4")
par(opar)
dev.off()
x<-as.matrix(m2)
sammon = do.sammon(x, ndim=2, preprocess = c("center"), initialize = "pca")
bmp("sammon_m2.bmp", width = 1280, height = 720)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2))
plot(sammon$Y, pch=19, col=1:12, main="m1")
plot(sammon$Y, pch=19, col=ckm2$cluster, main="m1 k=4")
par(opar)
dev.off()
x<-as.matrix(m3)
sammon = do.sammon(x, ndim=2, preprocess = c("center"), initialize = "pca")
bmp("sammon_m3.bmp", width = 1280, height = 720)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2))
plot(sammon$Y, pch=19, col=1:7, main="m1")
plot(sammon$Y, pch=19, col=ckm3$cluster, main="m1 k=6")
par(opar)
dev.off()
x<-as.matrix(m4)
sammon = do.sammon(x, ndim=2, preprocess = c("center"), initialize = "pca")
bmp("sammon_m4.bmp", width = 1280, height = 720)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2))
plot(sammon$Y, pch=19, col=1:6, main="m1")
plot(sammon$Y, pch=19, col=ckm4$cluster, main="m1 k=4")
par(opar)
dev.off()
x<-as.matrix(m5)
sammon = do.sammon(x, ndim=2, preprocess = c("center"), initialize = "pca")
bmp("sammon_m5.bmp", width = 1280, height = 720)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2))
plot(sammon$Y, pch=19, col=1:9, main="m1")
plot(sammon$Y, pch=19, col=ckm5$cluster, main="m1 k=4")
par(opar)
dev.off()
x<-as.matrix(m6)
sammon = do.sammon(x, ndim=2, preprocess = c("center"), initialize = "pca")
bmp("sammon_m6.bmp", width = 1280, height = 720)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2))
plot(sammon$Y, pch=19, col=1:9, main="m1")
plot(sammon$Y, pch=19, col=ckm6$cluster, main="m1 k=3")
par(opar)
dev.off()
x<-as.matrix(m7)
sammon = do.sammon(x, ndim=2, preprocess = c("center"), initialize = "pca")
bmp("sammon_m7.bmp", width = 1280, height = 720)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2))
plot(sammon$Y, pch=19, col=1:6, main="m1")
plot(sammon$Y, pch=19, col=ckm7$cluster, main="m1 k=4")
par(opar)
dev.off()
x<-as.matrix(m8)
sammon = do.sammon(x, ndim=2, preprocess = c("center"), initialize = "pca")
bmp("sammon_m8.bmp", width = 1280, height = 720)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2))
plot(sammon$Y, pch=19, col=1:6, main="m1")
plot(sammon$Y, pch=19, col=ckm8$cluster, main="m1 k=3")
par(opar)
dev.off()
x<-as.matrix(m9)
sammon = do.sammon(x, ndim=2, preprocess = c("center"), initialize = "pca")
bmp("sammon_m9.bmp", width = 1280, height = 720)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2))
plot(sammon$Y, pch=19, col=1:6, main="m1")
plot(sammon$Y, pch=19, col=ckm9$cluster, main="m1 k=3")
par(opar)
dev.off()
rm(x,opar)
dbscan::kNNdistplot(m1, k =  2)
abline(h = 0.15, lty = 2)
abline(h = 0.05, lty = 2)
abline(h = 0.1, lty = 2)
res.db <- dbscan::dbscan(m1, 0.1, 2)
gc()
bmp("dbscan_m1.bmp", width = 1980, height = 1280)
fviz_cluster(res.db, m1, geom = "point")
dev.off()
res.db <- dbscan::dbscan(m2, 0.105, 2)
gc()
bmp("dbscan_m2.bmp", width = 1980, height = 1280)
fviz_cluster(res.db, m2, geom = "point")
dev.off()
res.db <- dbscan::dbscan(m3, 0.04, 2)
gc()
bmp("dbscan_m3.bmp", width = 1980, height = 1280)
fviz_cluster(res.db, m3, geom = "point")
dev.off()
res.db <- dbscan::dbscan(m4, 0.07, 2)
gc()
bmp("dbscan_m4.bmp", width = 1980, height = 1280)
fviz_cluster(res.db, m4, geom = "point")
dev.off()
res.db <- dbscan::dbscan(m5, 0.09, 2)
gc()
bmp("dbscan_m5.bmp", width = 1980, height = 1280)
fviz_cluster(res.db, m5, geom = "point")
dev.off()
res.db <- dbscan::dbscan(m6, 0.035, 2)
gc()
bmp("dbscan_m6.bmp", width = 1980, height = 1280)
fviz_cluster(res.db, m6, geom = "point")
dev.off()
res.db <- dbscan::dbscan(m7, 0.04, 2)
gc()
bmp("dbscan_m7.bmp", width = 1980, height = 1280)
fviz_cluster(res.db, m7, geom = "point")
dev.off()
res.db <- dbscan::dbscan(m8, 0.03, 2)
gc()
bmp("dbscan_m8.bmp", width = 1980, height = 1280)
fviz_cluster(res.db, m8, geom = "point")
dev.off()
res.db <- dbscan::dbscan(m9, 0.03, 2)
gc()
bmp("dbscan_m9.bmp", width = 1980, height = 1280)
fviz_cluster(res.db, m9, geom = "point")
dev.off()
rm(res.db)
