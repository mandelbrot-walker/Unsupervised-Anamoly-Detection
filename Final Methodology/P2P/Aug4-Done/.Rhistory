grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m8
bmp("tsne_model1_m8_kmeans_k3.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_1_m8$Y), col = ckm8$cluster)
dev.off()
p1 <- fviz_cluster(ckm8, geom = "point",  data = as.data.frame(tsne_model_1_m8$Y)) + ggtitle("k = 3 m8")
bmp("tsne_model1_m8_kmeans_k4_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m9
bmp("tsne_model1_m9_kmeans_k3.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_1_m9$Y), col = ckm9$cluster)
dev.off()
p1 <- fviz_cluster(ckm9, geom = "point",  data = as.data.frame(tsne_model_1_m9$Y)) + ggtitle("k = 3 m9")
bmp("tsne_model1_m9_kmeans_k3_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
bmp("tsne_model2_m1_kmeans_k4.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_2_m1$Y), col = ckm1$cluster)
dev.off()
p1 <- fviz_cluster(ckm1, geom = "point",  data = as.data.frame(tsne_model_2_m1$Y)) + ggtitle("k = 4 m1")
bmp("tsne_model2_m1_kmeans_k4_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m2
bmp("tsne_model2_m2_kmeans_k4.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_2_m2$Y), col = ckm2$cluster)
dev.off()
p1 <- fviz_cluster(ckm2, geom = "point",  data = as.data.frame(tsne_model_2_m2$Y)) + ggtitle("k = 4 m2")
bmp("tsne_model2_m2_kmeans_k4_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m3
bmp("tsne_model2_m3_kmeans_k6.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_2_m3$Y), col = ckm3$cluster)
dev.off()
p1 <- fviz_cluster(ckm3, geom = "point",  data = as.data.frame(tsne_model_2_m3$Y)) + ggtitle("k = 6 m3")
bmp("tsne_model2_m3_kmeans_k6_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m4
bmp("tsne_model2_m4_kmeans_k4.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_2_m4$Y), col = ckm4$cluster)
dev.off()
p1 <- fviz_cluster(ckm4, geom = "point",  data = as.data.frame(tsne_model_2_m4$Y)) + ggtitle("k = 4 m4")
bmp("tsne_model2_m4_kmeans_k4_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m5
bmp("tsne_model2_m5_kmeans_k4.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_2_m5$Y), col = ckm5$cluster)
dev.off()
p1 <- fviz_cluster(ckm5, geom = "point",  data = as.data.frame(tsne_model_2_m5$Y)) + ggtitle("k = 4 m5")
bmp("tsne_model2_m5_kmeans_k4_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m6
bmp("tsne_model2_m6_kmeans_k3.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_2_m6$Y), col = ckm6$cluster)
dev.off()
p1 <- fviz_cluster(ckm6, geom = "point",  data = as.data.frame(tsne_model_2_m6$Y)) + ggtitle("k = 3 m6")
bmp("tsne_model2_m6_kmeans_k3_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m7
bmp("tsne_model2_m7_kmeans_k4.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_2_m7$Y), col = ckm7$cluster)
dev.off()
p1 <- fviz_cluster(ckm7, geom = "point",  data = as.data.frame(tsne_model_2_m7$Y)) + ggtitle("k = 4 m7")
bmp("tsne_model2_m7_kmeans_k4_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m8
bmp("tsne_model2_m8_kmeans_k3.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_2_m8$Y), col = ckm8$cluster)
dev.off()
p1 <- fviz_cluster(ckm8, geom = "point",  data = as.data.frame(tsne_model_2_m8$Y)) + ggtitle("k = 3 m8")
bmp("tsne_model2_m8_kmeans_k4_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m9
bmp("tsne_model2_m9_kmeans_k3.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_2_m9$Y), col = ckm9$cluster)
dev.off()
p1 <- fviz_cluster(ckm9, geom = "point",  data = as.data.frame(tsne_model_2_m9$Y)) + ggtitle("k = 3 m9")
bmp("tsne_model2_m9_kmeans_k3_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
bmp("tsne_model3_m1_kmeans_k4.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_3_m1$Y), col = ckm1$cluster)
dev.off()
p1 <- fviz_cluster(ckm1, geom = "point",  data = as.data.frame(tsne_model_3_m1$Y)) + ggtitle("k = 4 m1")
bmp("tsne_model3_m1_kmeans_k4_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m2
bmp("tsne_model3_m2_kmeans_k4.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_3_m2$Y), col = ckm2$cluster)
dev.off()
p1 <- fviz_cluster(ckm2, geom = "point",  data = as.data.frame(tsne_model_3_m2$Y)) + ggtitle("k = 4 m2")
bmp("tsne_model3_m2_kmeans_k4_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m3
bmp("tsne_model3_m3_kmeans_k6.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_3_m3$Y), col = ckm3$cluster)
dev.off()
p1 <- fviz_cluster(ckm3, geom = "point",  data = as.data.frame(tsne_model_3_m3$Y)) + ggtitle("k = 6 m3")
bmp("tsne_model3_m3_kmeans_k6_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m4
bmp("tsne_model3_m4_kmeans_k4.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_3_m4$Y), col = ckm4$cluster)
dev.off()
p1 <- fviz_cluster(ckm4, geom = "point",  data = as.data.frame(tsne_model_3_m4$Y)) + ggtitle("k = 4 m4")
bmp("tsne_model3_m4_kmeans_k4_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m5
bmp("tsne_model3_m5_kmeans_k4.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_3_m5$Y), col = ckm5$cluster)
dev.off()
p1 <- fviz_cluster(ckm5, geom = "point",  data = as.data.frame(tsne_model_3_m5$Y)) + ggtitle("k = 4 m5")
bmp("tsne_model3_m5_kmeans_k4_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m6
bmp("tsne_model3_m6_kmeans_k3.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_3_m6$Y), col = ckm6$cluster)
dev.off()
p1 <- fviz_cluster(ckm6, geom = "point",  data = as.data.frame(tsne_model_3_m6$Y)) + ggtitle("k = 3 m6")
bmp("tsne_model3_m6_kmeans_k3_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m7
bmp("tsne_model3_m7_kmeans_k4.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_3_m7$Y), col = ckm7$cluster)
dev.off()
p1 <- fviz_cluster(ckm7, geom = "point",  data = as.data.frame(tsne_model_3_m7$Y)) + ggtitle("k = 4 m7")
bmp("tsne_model3_m7_kmeans_k4_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m8
bmp("tsne_model3_m8_kmeans_k3.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_3_m8$Y), col = ckm8$cluster)
dev.off()
p1 <- fviz_cluster(ckm8, geom = "point",  data = as.data.frame(tsne_model_3_m8$Y)) + ggtitle("k = 3 m8")
bmp("tsne_model3_m8_kmeans_k4_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m9
bmp("tsne_model3_m9_kmeans_k3.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_3_m9$Y), col = ckm9$cluster)
dev.off()
p1 <- fviz_cluster(ckm9, geom = "point",  data = as.data.frame(tsne_model_3_m9$Y)) + ggtitle("k = 3 m9")
bmp("tsne_model3_m9_kmeans_k3_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
bmp("tsne_model4_m1_kmeans_k4.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_4_m1$Y), col = ckm1$cluster)
dev.off()
p1 <- fviz_cluster(ckm1, geom = "point",  data = as.data.frame(tsne_model_4_m1$Y)) + ggtitle("k = 4 m1")
bmp("tsne_model4_m1_kmeans_k4_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m2
bmp("tsne_model4_m2_kmeans_k4.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_4_m2$Y), col = ckm2$cluster)
dev.off()
p1 <- fviz_cluster(ckm2, geom = "point",  data = as.data.frame(tsne_model_4_m2$Y)) + ggtitle("k = 4 m2")
bmp("tsne_model4_m2_kmeans_k4_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m3
bmp("tsne_model4_m3_kmeans_k6.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_4_m3$Y), col = ckm3$cluster)
dev.off()
p1 <- fviz_cluster(ckm3, geom = "point",  data = as.data.frame(tsne_model_4_m3$Y)) + ggtitle("k = 6 m3")
bmp("tsne_model4_m3_kmeans_k6_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m4
bmp("tsne_model4_m4_kmeans_k4.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_4_m4$Y), col = ckm4$cluster)
dev.off()
p1 <- fviz_cluster(ckm4, geom = "point",  data = as.data.frame(tsne_model_4_m4$Y)) + ggtitle("k = 4 m4")
bmp("tsne_model4_m4_kmeans_k4_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m5
bmp("tsne_model4_m5_kmeans_k4.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_4_m5$Y), col = ckm5$cluster)
dev.off()
p1 <- fviz_cluster(ckm5, geom = "point",  data = as.data.frame(tsne_model_4_m5$Y)) + ggtitle("k = 4 m5")
bmp("tsne_model4_m5_kmeans_k4_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m6
bmp("tsne_model4_m6_kmeans_k3.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_4_m6$Y), col = ckm6$cluster)
dev.off()
p1 <- fviz_cluster(ckm6, geom = "point",  data = as.data.frame(tsne_model_4_m6$Y)) + ggtitle("k = 3 m6")
bmp("tsne_model4_m6_kmeans_k3_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m7
bmp("tsne_model4_m7_kmeans_k4.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_4_m7$Y), col = ckm7$cluster)
dev.off()
p1 <- fviz_cluster(ckm7, geom = "point",  data = as.data.frame(tsne_model_4_m7$Y)) + ggtitle("k = 4 m7")
bmp("tsne_model4_m7_kmeans_k4_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m8
bmp("tsne_model4_m8_kmeans_k3.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_4_m8$Y), col = ckm8$cluster)
dev.off()
p1 <- fviz_cluster(ckm8, geom = "point",  data = as.data.frame(tsne_model_4_m8$Y)) + ggtitle("k = 3 m8")
bmp("tsne_model4_m8_kmeans_k4_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m9
bmp("tsne_model4_m9_kmeans_k3.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_4_m9$Y), col = ckm9$cluster)
dev.off()
p1 <- fviz_cluster(ckm9, geom = "point",  data = as.data.frame(tsne_model_4_m9$Y)) + ggtitle("k = 3 m9")
bmp("tsne_model4_m9_kmeans_k3_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
x<-as.matrix(m1)
sammon = do.sammon(x, ndim=2, preprocess = c("center"), initialize = "pca")
bmp("sammon_m1.bmp", width = 1280, height = 720)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2))
plot(sammon$Y, pch=19, col=factor(ncen_tr$names), main="m1")
plot(sammon$Y, pch=19, col=ckm1$cluster, main="m1 k=2")
par(opar)
dev.off()
x<-as.matrix(m1)
sammon = do.sammon(x, ndim=2, preprocess = c("center"), initialize = "pca")
bmp("sammon_m1.bmp", width = 1280, height = 720)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2))
plot(sammon$Y, pch=19, col=factor(ncen_tr$names), main="m1")
plot(sammon$Y, pch=19, col=ckm1$cluster, main="m1 k=4")
par(opar)
dev.off()
x<-as.matrix(m2)
sammon = do.sammon(x, ndim=2, preprocess = c("center"), initialize = "pca")
bmp("sammon_m2.bmp", width = 1280, height = 720)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2))
plot(sammon$Y, pch=19, col=1:12, main="m1")
plot(sammon$Y, pch=19, col=ckm2$cluster, main="m1 k=4")
par(opar)
dev.off()
x<-as.matrix(m3)
sammon = do.sammon(x, ndim=2, preprocess = c("center"), initialize = "pca")
bmp("sammon_m3.bmp", width = 1280, height = 720)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2))
plot(sammon$Y, pch=19, col=1:7, main="m1")
plot(sammon$Y, pch=19, col=ckm3$cluster, main="m1 k=6")
par(opar)
dev.off()
x<-as.matrix(m4)
sammon = do.sammon(x, ndim=2, preprocess = c("center"), initialize = "pca")
bmp("sammon_m4.bmp", width = 1280, height = 720)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2))
plot(sammon$Y, pch=19, col=1:6, main="m1")
plot(sammon$Y, pch=19, col=ckm4$cluster, main="m1 k=4")
par(opar)
dev.off()
x<-as.matrix(m5)
sammon = do.sammon(x, ndim=2, preprocess = c("center"), initialize = "pca")
bmp("sammon_m5.bmp", width = 1280, height = 720)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2))
plot(sammon$Y, pch=19, col=1:9, main="m1")
plot(sammon$Y, pch=19, col=ckm5$cluster, main="m1 k=4")
par(opar)
dev.off()
x<-as.matrix(m6)
sammon = do.sammon(x, ndim=2, preprocess = c("center"), initialize = "pca")
bmp("sammon_m6.bmp", width = 1280, height = 720)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2))
plot(sammon$Y, pch=19, col=1:9, main="m1")
plot(sammon$Y, pch=19, col=ckm6$cluster, main="m1 k=3")
par(opar)
dev.off()
x<-as.matrix(m7)
sammon = do.sammon(x, ndim=2, preprocess = c("center"), initialize = "pca")
bmp("sammon_m7.bmp", width = 1280, height = 720)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2))
plot(sammon$Y, pch=19, col=1:6, main="m1")
plot(sammon$Y, pch=19, col=ckm7$cluster, main="m1 k=4")
par(opar)
dev.off()
x<-as.matrix(m8)
sammon = do.sammon(x, ndim=2, preprocess = c("center"), initialize = "pca")
bmp("sammon_m8.bmp", width = 1280, height = 720)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2))
plot(sammon$Y, pch=19, col=1:6, main="m1")
plot(sammon$Y, pch=19, col=ckm8$cluster, main="m1 k=3")
par(opar)
dev.off()
x<-as.matrix(m9)
sammon = do.sammon(x, ndim=2, preprocess = c("center"), initialize = "pca")
bmp("sammon_m9.bmp", width = 1280, height = 720)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2))
plot(sammon$Y, pch=19, col=1:6, main="m1")
plot(sammon$Y, pch=19, col=ckm9$cluster, main="m1 k=3")
par(opar)
dev.off()
rm(x,opar)
xyMclust <- Mclust(as.matrix(m1), prior = priorControl(),
control = emControl(),
warn = mclust.options("warn"),
verbose = TRUE)
summary(xyMclust, parameters = TRUE)
plot(mclustBIC(m1))
plot(mclustBIC(m2))
plot(xyMclust)
plot(xyMclust, what=c("classification"))
c1$cluster<-xyMclust$classification
fviz_cluster(xyMclust$classification, geom = "point",  data = m1) + ggtitle("k = 9 m1")
c1<-xyMclust$classification
fviz_cluster(c1, geom = "point",  data = m1) + ggtitle("k = 9 m1")
c1<-ckm1
c1$cluster<-xyMclust$classification
fviz_cluster(c1, geom = "point",  data = m1) + ggtitle("k = 9 m1")
fviz_mclust(xyMclust,what = c("classification"), geom = "point",ellipse.type = "norm",palette = "jco" )
fviz_mclust(xyMclust,what = c("uncertainty"),ellipse.type = "norm",palette = "jco" )
fviz_mclust(clustgmm,what = c("classification"), geom = "point",ellipse.type = "norm",palette = "jco" )
p1<-fviz_cluster(c1, geom = "point",  data = m1) + ggtitle("k = 9 m1")
p2<-fviz_mclust(xyMclust,what = c("classification"), geom = "point",ellipse.type = "norm",palette = "jco" )
p3<-fviz_mclust(xyMclust,what = c("uncertainty"),ellipse.type = "norm",palette = "jco" )
bmp("GMM_fit.bmp", width = 1980, height = 1280)
grid.arrange(p1,p2,p3, nrow = 1)
dev.off()
bmp("GMM_fit.bmp", width = 1480, height = 1200)
grid.arrange(p1,p2,p3, nrow = 1)
dev.off()
bmp("GMM_fit.bmp", width = 1980, height = 620)
grid.arrange(p1,p2,p3, nrow = 1)
dev.off()
xyMclust9 <- Mclust(as.matrix(m9), prior = priorControl(),
control = emControl(),
warn = mclust.options("warn"),
verbose = TRUE)
summary(xyMclust9, parameters = TRUE)
xyMclust4 <- Mclust(as.matrix(m1), prior = priorControl(),
control = emControl(),
warn = mclust.options("warn"),
verbose = TRUE)
summary(xyMclust4, parameters = TRUE)
fviz_cluster(ckm1, geom = "point",  data = umap_m1) + ggtitle("k = 9 m1")
plot(umap_m1$UMAP1,umap_m1$UMAP2, col=factor(umap_m1$UMAP1))
fviz_cluster(ckm1, geom = "point",  data = umap_m1) + ggtitle("k = 4 m1")
bmp("umap_m1.bmp", width = 1440, height = 620)
plot(umap_m1$UMAP1,umap_m1$UMAP2, col=factor(umap_m1$UMAP1))
dev.off()
bmp("umap_m1_k4.bmp", width = 1440, height = 620)
fviz_cluster(ckm1, geom = "point",  data = umap_m1) + ggtitle("k = 4 m1")
dev.off()
bmp("umap_m1.bmp", width = 1920, height = 1280)
plot(umap_m1$UMAP1,umap_m1$UMAP2, col=factor(umap_m1$UMAP1))
dev.off()
bmp("umap_m1_k4.bmp", width = 1920, height = 1280)
fviz_cluster(ckm1, geom = "point",  data = umap_m1) + ggtitle("k = 4 m1")
dev.off()
umap_calc <- umap(m9, n_neighbors = ngb, n_components = 2,metric = "cosine",
learning_rate = lr, scale = T, init = "spectral",
bandwidth = 30, negative_sample_rate = 20, n_trees = 50,
search_k = 2*90*50, pca_center = T, pcg_rand = T, ret_model = T,
ret_nn = T, n_threads = nthr, verbose = getOption("verbose",TRUE),
grain_size = 5,  min_dist = 10, spread = 50 )
umap_m9 <- data.frame(
UMAP1 = umap_calc$embedding[, 1],
UMAP2 = umap_calc$embedding[, 2]
)
bmp("umap_m9.bmp", width = 1920, height = 1280)
plot(umap_m9$UMAP1,umap_m9$UMAP2, col=factor(umap_m9$UMAP1))
dev.off()
bmp("umap_m9_k3.bmp", width = 1920, height = 1280)
fviz_cluster(ckm9, geom = "point",  data = umap_m9) + ggtitle("k = 3 m9")
dev.off()
umap_calc <- umap(m2, n_neighbors = ngb, n_components = 2,metric = "cosine",
learning_rate = lr, scale = T, init = "spectral",
bandwidth = 30, negative_sample_rate = 20, n_trees = 50,
search_k = 2*90*50, pca_center = T, pcg_rand = T, ret_model = T,
ret_nn = T, n_threads = nthr, verbose = getOption("verbose",TRUE),
grain_size = 5,  min_dist = 10, spread = 50 )
umap_m2 <- data.frame(
UMAP1 = umap_calc$embedding[, 1],
UMAP2 = umap_calc$embedding[, 2]
)
bmp("umap_m2.bmp", width = 1920, height = 1280)
plot(umap_m2$UMAP1,umap_m2$UMAP2, col=factor(umap_m2$UMAP1))
dev.off()
bmp("umap_m2_k4.bmp", width = 1920, height = 1280)
fviz_cluster(ckm2, geom = "point",  data = umap_m2) + ggtitle("k = 4 m2")
dev.off()
#  Umap m3
umap_calc <- umap(m3, n_neighbors = ngb, n_components = 2,metric = "cosine",
learning_rate = lr, scale = T, init = "spectral",
bandwidth = 30, negative_sample_rate = 20, n_trees = 50,
search_k = 2*90*50, pca_center = T, pcg_rand = T, ret_model = T,
ret_nn = T, n_threads = nthr, verbose = getOption("verbose",TRUE),
grain_size = 5,  min_dist = 10, spread = 50 )
umap_m3 <- data.frame(
UMAP1 = umap_calc$embedding[, 1],
UMAP2 = umap_calc$embedding[, 2]
)
bmp("umap_m3.bmp", width = 1920, height = 1280)
plot(umap_m3$UMAP1,umap_m3$UMAP2, col=factor(umap_m3$UMAP1))
dev.off()
bmp("umap_m3_k6.bmp", width = 1920, height = 1280)
fviz_cluster(ckm3, geom = "point",  data = umap_m3) + ggtitle("k = 6 m3")
dev.off()
#  Umap m4
umap_calc <- umap(m4, n_neighbors = ngb, n_components = 2,metric = "cosine",
learning_rate = lr, scale = T, init = "spectral",
bandwidth = 30, negative_sample_rate = 20, n_trees = 50,
search_k = 2*90*50, pca_center = T, pcg_rand = T, ret_model = T,
ret_nn = T, n_threads = nthr, verbose = getOption("verbose",TRUE),
grain_size = 5,  min_dist = 10, spread = 50 )
umap_m4 <- data.frame(
UMAP1 = umap_calc$embedding[, 1],
UMAP2 = umap_calc$embedding[, 2]
)
bmp("umap_m4.bmp", width = 1920, height = 1280)
plot(umap_m4$UMAP1,umap_m4$UMAP2, col=factor(umap_m4$UMAP1))
dev.off()
bmp("umap_m4_k4.bmp", width = 1920, height = 1280)
fviz_cluster(ckm4, geom = "point",  data = umap_m4) + ggtitle("k = 4 m4")
dev.off()
#  Umap m5
umap_calc <- umap(m5, n_neighbors = ngb, n_components = 2,metric = "cosine",
learning_rate = lr, scale = T, init = "spectral",
bandwidth = 30, negative_sample_rate = 20, n_trees = 50,
search_k = 2*90*50, pca_center = T, pcg_rand = T, ret_model = T,
ret_nn = T, n_threads = nthr, verbose = getOption("verbose",TRUE),
grain_size = 5,  min_dist = 10, spread = 50 )
umap_m5 <- data.frame(
UMAP1 = umap_calc$embedding[, 1],
UMAP2 = umap_calc$embedding[, 2]
)
bmp("umap_m5.bmp", width = 1920, height = 1280)
plot(umap_m5$UMAP1,umap_m5$UMAP2, col=factor(umap_m5$UMAP1))
dev.off()
bmp("umap_m5_k4.bmp", width = 1920, height = 1280)
fviz_cluster(ckm5, geom = "point",  data = umap_m5) + ggtitle("k = 4 m5")
dev.off()
#  Umap m6
umap_calc <- umap(m6, n_neighbors = ngb, n_components = 2,metric = "cosine",
learning_rate = lr, scale = T, init = "spectral",
bandwidth = 30, negative_sample_rate = 20, n_trees = 50,
search_k = 2*90*50, pca_center = T, pcg_rand = T, ret_model = T,
ret_nn = T, n_threads = nthr, verbose = getOption("verbose",TRUE),
grain_size = 5,  min_dist = 10, spread = 50 )
umap_m6 <- data.frame(
UMAP1 = umap_calc$embedding[, 1],
UMAP2 = umap_calc$embedding[, 2]
)
bmp("umap_m6.bmp", width = 1920, height = 1280)
plot(umap_m6$UMAP1,umap_m6$UMAP2, col=factor(umap_m6$UMAP1))
dev.off()
bmp("umap_m6_k3.bmp", width = 1920, height = 1280)
fviz_cluster(ckm6, geom = "point",  data = umap_m6) + ggtitle("k = 3 m6")
dev.off()
#  Umap m7
umap_calc <- umap(m7, n_neighbors = ngb, n_components = 2,metric = "cosine",
learning_rate = lr, scale = T, init = "spectral",
bandwidth = 30, negative_sample_rate = 20, n_trees = 50,
search_k = 2*90*50, pca_center = T, pcg_rand = T, ret_model = T,
ret_nn = T, n_threads = nthr, verbose = getOption("verbose",TRUE),
grain_size = 5,  min_dist = 10, spread = 50 )
umap_m7 <- data.frame(
UMAP1 = umap_calc$embedding[, 1],
UMAP2 = umap_calc$embedding[, 2]
)
bmp("umap_m7.bmp", width = 1920, height = 1280)
plot(umap_m7$UMAP1,umap_m7$UMAP2, col=factor(umap_m7$UMAP1))
dev.off()
bmp("umap_m7_k4.bmp", width = 1920, height = 1280)
fviz_cluster(ckm7, geom = "point",  data = umap_m7) + ggtitle("k = 4 m7")
dev.off()
#  Umap m8
umap_calc <- umap(m8, n_neighbors = ngb, n_components = 2,metric = "cosine",
learning_rate = lr, scale = T, init = "spectral",
bandwidth = 30, negative_sample_rate = 20, n_trees = 50,
search_k = 2*90*50, pca_center = T, pcg_rand = T, ret_model = T,
ret_nn = T, n_threads = nthr, verbose = getOption("verbose",TRUE),
grain_size = 5,  min_dist = 10, spread = 50 )
umap_m8 <- data.frame(
UMAP1 = umap_calc$embedding[, 1],
UMAP2 = umap_calc$embedding[, 2]
)
bmp("umap_m8.bmp", width = 1920, height = 1280)
plot(umap_m8$UMAP1,umap_m8$UMAP2, col=factor(umap_m8$UMAP1))
dev.off()
bmp("umap_m8_k3.bmp", width = 1920, height = 1280)
fviz_cluster(ckm8, geom = "point",  data = umap_m8) + ggtitle("k = 3 m8")
dev.off()
