ck10<-Skmeans(data=as.matrix(m8),centers=10,iter.max = 25,nthread = 5,init = c("random"),tolerance = 0.0005)
gc()
ck11<-Skmeans(data=as.matrix(m8),centers=11,iter.max = 25,nthread = 5,init = c("random"),tolerance = 0.0005)
gc()
ck12<-Skmeans(data=as.matrix(m8),centers=12,iter.max = 25,nthread = 5,init = c("random"),tolerance = 0.0005)
gc()
ck13<-Skmeans(data=as.matrix(m8),centers=13,iter.max = 25,nthread = 5,init = c("random"),tolerance = 0.0005)
gc()
ck14<-Skmeans(data=as.matrix(m8),centers=14,iter.max = 25,nthread = 5,init = c("random"),tolerance = 0.0005)
gc()
ck15<-Skmeans(data=as.matrix(m8),centers=15,iter.max = 25,nthread = 5,init = c("random"),tolerance = 0.0005)
gc()
round(calinhara(m8,ck2$cluster),digits=2) #  17915.95
round(calinhara(m8,ck3$cluster),digits=3) #  10646.27
round(calinhara(m8,ck4$cluster),digits=4) #  8347.888
round(calinhara(m8,ck5$cluster),digits=5) #  6792.035
round(calinhara(m8,ck6$cluster),digits=6) #  7374.408
round(calinhara(m8,ck7$cluster),digits=7) #  20465.38
round(calinhara(m8,ck8$cluster),digits=8) #  3577.276
round(calinhara(m8,ck9$cluster),digits=9) #  24277.39  Highest
round(calinhara(m8,ck10$cluster),digits=10) #  5333.766
round(calinhara(m8,ck11$cluster),digits=11) #  5103.492
round(calinhara(m8,ck12$cluster),digits=12) #  17126.75
round(calinhara(m8,ck13$cluster),digits=13) #  2414.648
round(calinhara(m8,ck14$cluster),digits=14) #  10406.77
round(calinhara(m8,ck15$cluster),digits=15) #  13902.34
library(fpc)
library(kohonen)
round(calinhara(m8,ck2$cluster),digits=2) #  17915.95
round(calinhara(m8,ck3$cluster),digits=3) #  10646.27
round(calinhara(m8,ck4$cluster),digits=4) #  8347.888
round(calinhara(m8,ck5$cluster),digits=5) #  6792.035
round(calinhara(m8,ck6$cluster),digits=6) #  7374.408
round(calinhara(m8,ck7$cluster),digits=7) #  20465.38
round(calinhara(m8,ck8$cluster),digits=8) #  3577.276
round(calinhara(m8,ck9$cluster),digits=9) #  24277.39  Highest
round(calinhara(m8,ck10$cluster),digits=10) #  5333.766
round(calinhara(m8,ck11$cluster),digits=11) #  5103.492
round(calinhara(m8,ck12$cluster),digits=12) #  17126.75
round(calinhara(m8,ck13$cluster),digits=13) #  2414.648
round(calinhara(m8,ck14$cluster),digits=14) #  10406.77
round(calinhara(m8,ck15$cluster),digits=15) #  13902.34
library(igraph) #  centralities
library(centiserve) #  centralities
library(factoextra)  # fviz_cluster()
library(Rtsne) #  TSNE
library(Plasmidprofiler) #  normalize()
library(data.table) #  transpose()
library(corrplot) #  correlation plot
library(gridExtra) #  multiplot
library(CINNA) #  centralities
library(Rdimtools) #  sammon's map
library(fpc) #  calinhara()
library(clusternor) # skmeans
ck2<-Skmeans(data=as.matrix(m1),centers=2,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck3<-Skmeans(data=as.matrix(m1),centers=3,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck4<-Skmeans(data=as.matrix(m1),centers=4,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck5<-Skmeans(data=as.matrix(m1),centers=5,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck6<-Skmeans(data=as.matrix(m1),centers=6,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()  # garbage collection is used for stack imbalance warning. run gc() more than once if the warning persists
round(calinhara(m1,ck2$cluster),digits=2) #  12522.27
round(calinhara(m1,ck3$cluster),digits=3) #  34570.29
round(calinhara(m1,ck4$cluster),digits=4) #  44242.33  Highest
round(calinhara(m1,ck5$cluster),digits=5) #  43574.56
round(calinhara(m1,ck6$cluster),digits=6) #  13826.99
ck7<-Skmeans(data=as.matrix(m1),centers=7,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck8<-Skmeans(data=as.matrix(m1),centers=8,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck9<-Skmeans(data=as.matrix(m1),centers=9,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck10<-Skmeans(data=as.matrix(m1),centers=10,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
round(calinhara(m1,ck7$cluster),digits=7) #  42654.56
round(calinhara(m1,ck8$cluster),digits=8) #  42654.56
round(calinhara(m1,ck9$cluster),digits=9) #  42654.56
round(calinhara(m1,ck10$cluster),digits=10)
ck10<-Skmeans(data=as.matrix(m1),centers=11,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
round(calinhara(m1,ck10$cluster),digits=11) #  43537.76
0
ck10<-Skmeans(data=as.matrix(m1),centers=10,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
ck2<-Skmeans(data=as.matrix(m2),centers=2,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck3<-Skmeans(data=as.matrix(m2),centers=3,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck4<-Skmeans(data=as.matrix(m2),centers=4,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck5<-Skmeans(data=as.matrix(m2),centers=5,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck6<-Skmeans(data=as.matrix(m2),centers=6,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
round(calinhara(m2,ck2$cluster),digits=2) #  12586.2
round(calinhara(m2,ck3$cluster),digits=3) #  34960.27
round(calinhara(m2,ck4$cluster),digits=4) #  44999.63  Highest
round(calinhara(m2,ck5$cluster),digits=5) #  43092.98
round(calinhara(m2,ck6$cluster),digits=6) #  13982.97
ck7<-Skmeans(data=as.matrix(m2),centers=7,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck8<-Skmeans(data=as.matrix(m2),centers=8,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck9<-Skmeans(data=as.matrix(m2),centers=9,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck10<-Skmeans(data=as.matrix(m2),centers=10,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
round(calinhara(m2,ck2$cluster),digits=2) #  12997.19
round(calinhara(m2,ck3$cluster),digits=3) #  34960.27
round(calinhara(m2,ck4$cluster),digits=4) #  44978.74  Highest
round(calinhara(m2,ck5$cluster),digits=5) #  44174.32
round(calinhara(m2,ck6$cluster),digits=6) #  43284.42
round(calinhara(m2,ck7$cluster),digits=7) #  43284.42
round(calinhara(m2,ck8$cluster),digits=8) #  43284.42
round(calinhara(m2,ck9$cluster),digits=9) #  43284.42
round(calinhara(m2,ck10$cluster),digits=10) #  43284.42
unique(ck4$cluster)
unique(ck9$cluster)
save.image(".Rdata",safe = TRUE)
ck2<-Skmeans(data=as.matrix(m2),centers=2,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck3<-Skmeans(data=as.matrix(m2),centers=3,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck4<-Skmeans(data=as.matrix(m2),centers=4,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck5<-Skmeans(data=as.matrix(m2),centers=5,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck6<-Skmeans(data=as.matrix(m2),centers=6,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck7<-Skmeans(data=as.matrix(m2),centers=7,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck8<-Skmeans(data=as.matrix(m2),centers=8,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck9<-Skmeans(data=as.matrix(m2),centers=9,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck10<-Skmeans(data=as.matrix(m2),centers=10,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
#  Checking for correct no of clusters. Higher the index value better the cluster
round(calinhara(m2,ck2$cluster),digits=2) #  12997.19
round(calinhara(m2,ck3$cluster),digits=3) #  34960.27
round(calinhara(m2,ck4$cluster),digits=4) #  44978.74
round(calinhara(m2,ck5$cluster),digits=5) #  44174.32
round(calinhara(m2,ck6$cluster),digits=6) #  43284.42
round(calinhara(m2,ck7$cluster),digits=7) #  42648.32
round(calinhara(m2,ck8$cluster),digits=8) #  44910.6
round(calinhara(m2,ck9$cluster),digits=9) #  45455.04  Highest
round(calinhara(m2,ck10$cluster),digits=10) #  44112.46
ck2<-Skmeans(data=as.matrix(m3),centers=2,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck3<-Skmeans(data=as.matrix(m3),centers=3,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck4<-Skmeans(data=as.matrix(m3),centers=4,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck5<-Skmeans(data=as.matrix(m3),centers=5,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck6<-Skmeans(data=as.matrix(m3),centers=6,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck7<-Skmeans(data=as.matrix(m3),centers=7,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck8<-Skmeans(data=as.matrix(m3),centers=8,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck9<-Skmeans(data=as.matrix(m3),centers=9,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck10<-Skmeans(data=as.matrix(m3),centers=10,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck11<-Skmeans(data=as.matrix(m3),centers=11,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck12<-Skmeans(data=as.matrix(m3),centers=12,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck13<-Skmeans(data=as.matrix(m3),centers=13,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck14<-Skmeans(data=as.matrix(m3),centers=14,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck15<-Skmeans(data=as.matrix(m3),centers=15,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
round(calinhara(m3,ck2$cluster),digits=2) #  31779.44
round(calinhara(m3,ck3$cluster),digits=3) #  36158.88
round(calinhara(m3,ck4$cluster),digits=4) #  31439.18
round(calinhara(m3,ck5$cluster),digits=5) #  33797.56
round(calinhara(m3,ck6$cluster),digits=6) #  43673.86
round(calinhara(m3,ck7$cluster),digits=7) #  27916.25
round(calinhara(m3,ck8$cluster),digits=8) #  32471.31
round(calinhara(m3,ck9$cluster),digits=9) #  31402.12
round(calinhara(m3,ck10$cluster),digits=10) #  49263.96
round(calinhara(m3,ck11$cluster),digits=11) #  45950.03
round(calinhara(m3,ck12$cluster),digits=12) #  25284.46
round(calinhara(m3,ck13$cluster),digits=13) #  49379.08  Highest
round(calinhara(m3,ck14$cluster),digits=15) #  23194.46
round(calinhara(m3,ck15$cluster),digits=15) #  23809.6
save.image(".Rdata",safe = TRUE)
unique(ck5$cluster)
ck2<-Skmeans(data=as.matrix(m4),centers=2,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck3<-Skmeans(data=as.matrix(m4),centers=3,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck4<-Skmeans(data=as.matrix(m4),centers=4,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck5<-Skmeans(data=as.matrix(m4),centers=5,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck6<-Skmeans(data=as.matrix(m4),centers=6,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck7<-Skmeans(data=as.matrix(m4),centers=7,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck8<-Skmeans(data=as.matrix(m4),centers=8,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck9<-Skmeans(data=as.matrix(m4),centers=9,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck10<-Skmeans(data=as.matrix(m4),centers=10,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck11<-Skmeans(data=as.matrix(m4),centers=11,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
round(calinhara(m4,ck2$cluster),digits=2) #  21443.88
round(calinhara(m4,ck3$cluster),digits=3) #  29880.67
round(calinhara(m4,ck4$cluster),digits=4) #  47091.77  Highest
round(calinhara(m4,ck5$cluster),digits=5) #  20043.71
round(calinhara(m4,ck6$cluster),digits=6) #  9012.33
round(calinhara(m4,ck7$cluster),digits=7) #  33524.8
round(calinhara(m4,ck8$cluster),digits=8) #  19981.15
round(calinhara(m4,ck9$cluster),digits=9) #  30400.5
round(calinhara(m4,ck10$cluster),digits=10) #  20484.42
round(calinhara(m4,ck11$cluster),digits=11) #  8654.15
ck2<-Skmeans(data=as.matrix(m5),centers=2,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck3<-Skmeans(data=as.matrix(m5),centers=3,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck4<-Skmeans(data=as.matrix(m5),centers=4,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck5<-Skmeans(data=as.matrix(m5),centers=5,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck6<-Skmeans(data=as.matrix(m5),centers=6,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck7<-Skmeans(data=as.matrix(m5),centers=6,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
round(calinhara(m5,ck2$cluster),digits=2) #  12850.18
round(calinhara(m5,ck3$cluster),digits=3) #  36626.3
round(calinhara(m5,ck4$cluster),digits=4) #  48429.99  Highest
round(calinhara(m5,ck5$cluster),digits=5) #  47072.32
round(calinhara(m5,ck6$cluster),digits=6) #  14649.32
round(calinhara(m5,ck7$cluster),digits=7) #  14649.32
ck8<-Skmeans(data=as.matrix(m5),centers=8,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck9<-Skmeans(data=as.matrix(m5),centers=9,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck10<-Skmeans(data=as.matrix(m5),centers=10,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
round(calinhara(m5,ck7$cluster),digits=8) #  14649.32
round(calinhara(m5,ck7$cluster),digits=9) #  14649.32
round(calinhara(m5,ck7$cluster),digits=10) #  14649.32
save.image(".Rdata",safe = TRUE)
ck2<-Skmeans(data=as.matrix(m6),centers=2,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck3<-Skmeans(data=as.matrix(m6),centers=3,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck4<-Skmeans(data=as.matrix(m6),centers=4,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck5<-Skmeans(data=as.matrix(m6),centers=5,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck6<-Skmeans(data=as.matrix(m6),centers=6,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck7<-Skmeans(data=as.matrix(m6),centers=6,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
#  Checking for correct no of clusters. Higher the index value better the cluster
round(calinhara(m6,ck2$cluster),digits=2) #  26209.5  Highest
round(calinhara(m6,ck3$cluster),digits=3) #  14362.41
round(calinhara(m6,ck4$cluster),digits=4) #  11341.19
round(calinhara(m6,ck5$cluster),digits=5) #  8763.63
round(calinhara(m6,ck6$cluster),digits=6) #  7010.713
round(calinhara(m6,ck7$cluster),digits=7) #  7010.713
ck2<-Skmeans(data=as.matrix(m7),centers=2,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck3<-Skmeans(data=as.matrix(m7),centers=3,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck4<-Skmeans(data=as.matrix(m7),centers=4,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck5<-Skmeans(data=as.matrix(m7),centers=5,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck6<-Skmeans(data=as.matrix(m7),centers=6,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck7<-Skmeans(data=as.matrix(m7),centers=7,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
round(calinhara(m7,ck2$cluster),digits=2) #  45716.64  Highest
round(calinhara(m7,ck3$cluster),digits=3) #  33277.4
round(calinhara(m7,ck4$cluster),digits=4) #  25630.05
round(calinhara(m7,ck5$cluster),digits=5) #  21485.9
round(calinhara(m7,ck6$cluster),digits=6) #  18608.65
round(calinhara(m7,ck7$cluster),digits=7) #  17271.18
ck2<-Skmeans(data=as.matrix(m8),centers=2,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck3<-Skmeans(data=as.matrix(m8),centers=3,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck4<-Skmeans(data=as.matrix(m8),centers=4,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck5<-Skmeans(data=as.matrix(m8),centers=5,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck6<-Skmeans(data=as.matrix(m8),centers=6,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck7<-Skmeans(data=as.matrix(m8),centers=7,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck8<-Skmeans(data=as.matrix(m8),centers=8,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck9<-Skmeans(data=as.matrix(m8),centers=9,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck10<-Skmeans(data=as.matrix(m8),centers=10,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck11<-Skmeans(data=as.matrix(m8),centers=11,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck12<-Skmeans(data=as.matrix(m8),centers=12,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck13<-Skmeans(data=as.matrix(m8),centers=13,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck14<-Skmeans(data=as.matrix(m8),centers=14,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck15<-Skmeans(data=as.matrix(m8),centers=15,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
round(calinhara(m8,ck2$cluster),digits=2) #  17915.95
round(calinhara(m8,ck3$cluster),digits=3) #  10646.27
round(calinhara(m8,ck4$cluster),digits=4) #  8347.888
round(calinhara(m8,ck5$cluster),digits=5) #  6792.035
round(calinhara(m8,ck6$cluster),digits=6) #  7374.408
round(calinhara(m8,ck7$cluster),digits=7) #  20465.38
round(calinhara(m8,ck8$cluster),digits=8) #  3577.276
round(calinhara(m8,ck9$cluster),digits=9) #  24277.39  Highest
round(calinhara(m8,ck10$cluster),digits=10) #  5333.766
round(calinhara(m8,ck11$cluster),digits=11) #  5103.492
round(calinhara(m8,ck12$cluster),digits=12) #  17126.75
round(calinhara(m8,ck13$cluster),digits=13) #  2414.648
round(calinhara(m8,ck14$cluster),digits=14) #  10406.77
round(calinhara(m8,ck15$cluster),digits=15) #  13902.34
unique(ck9$cluster)
ck2<-Skmeans(data=as.matrix(m9),centers=2,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck3<-Skmeans(data=as.matrix(m9),centers=3,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck4<-Skmeans(data=as.matrix(m9),centers=4,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck5<-Skmeans(data=as.matrix(m9),centers=5,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck6<-Skmeans(data=as.matrix(m9),centers=6,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck7<-Skmeans(data=as.matrix(m8),centers=7,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck8<-Skmeans(data=as.matrix(m4),centers=8,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck9<-Skmeans(data=as.matrix(m4),centers=9,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck10<-Skmeans(data=as.matrix(m4),centers=10,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ck11<-Skmeans(data=as.matrix(m4),centers=11,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
round(calinhara(m9,ck2$cluster),digits=2) #  19898.14
round(calinhara(m9,ck3$cluster),digits=3) #  11922.73
round(calinhara(m9,ck4$cluster),digits=4) #  10786.46
round(calinhara(m9,ck5$cluster),digits=5) #  8470.432
round(calinhara(m9,ck6$cluster),digits=6) #  27624.62
round(calinhara(m9,ck7$cluster),digits=7) #  29222.08  Highest
round(calinhara(m9,ck8$cluster),digits=8) #  21388.38
round(calinhara(m9,ck9$cluster),digits=9) #  28394.08
round(calinhara(m9,ck10$cluster),digits=10) #  18826.03
round(calinhara(m9,ck11$cluster),digits=11) #  12832.49
rm(ck2,ck3,ck4,ck5,ck6,ck7,ck8,ck9,ck10,ck11,ck12,ck13,ck14,ck15)
unique(ck8$cluster)
ckm1<-Skmeans(data=as.matrix(m1),centers=9,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ckm2<-Skmeans(data=as.matrix(m2),centers=9,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ckm3<-Skmeans(data=as.matrix(m3),centers=5,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ckm4<-Skmeans(data=as.matrix(m4),centers=7,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ckm5<-Skmeans(data=as.matrix(m5),centers=4,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ckm6<-Skmeans(data=as.matrix(m6),centers=2,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ckm7<-Skmeans(data=as.matrix(m7),centers=2,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ckm8<-Skmeans(data=as.matrix(m8),centers=2,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()
ckm9<-Skmeans(data=as.matrix(m9),centers=8,iter.max = 25,nthread = 5,init = c("kmeanspp"),tolerance = 0.0005)
gc()  #
unique(ckm8$cluster)
unique(ckm9$cluster)
ck1<-kmeans(m1, 3, iter.max = 20, nstart = 25,
algorithm = c("Hartigan-Wong"), trace=FALSE) #  dummy kmeans
ck2<-ck1
ck3<-ck1
ck4<-ck1
ck5<-ck1
ck6<-ck1
ck7<-ck1
ck8<-ck1
ck9<-ck1
#  m1
bmp("tsne_model1_m1_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_1_m1$Y), col = ckm1$cluster)
dev.off()
ck1$cluster<-ckm1$cluster
ck1$centers<-ckm1$centers
ck1$size<-ckm1$size
ck1$iter<-ckm1$iters
p1 <- fviz_cluster(ck1, geom = "point",  data = as.data.frame(tsne_model_1_m1$Y))
bmp("tsne_model1_m1_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m2
bmp("tsne_model1_m2_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_1_m2$Y), col = ckm2$cluster)
dev.off()
ck2$cluster<-ckm2$cluster
ck2$centers<-ckm2$centers
ck2$size<-ckm2$size
ck2$iter<-ckm2$iters
p1 <- fviz_cluster(ck2, geom = "point",  data = as.data.frame(tsne_model_1_m2$Y))
bmp("tsne_model1_m2_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m3
bmp("tsne_model1_m3_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_1_m3$Y), col = ckm3$cluster)
dev.off()
ck3$cluster<-ckm3$cluster
ck3$centers<-ckm3$centers
ck3$size<-ckm3$size
ck3$iter<-ckm3$iters
p1 <- fviz_cluster(ck3, geom = "point",  data = as.data.frame(tsne_model_1_m3$Y))
bmp("tsne_model1_m3_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m4
bmp("tsne_model1_m4_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_1_m4$Y), col = ckm4$cluster)
dev.off()
ck4$cluster<-ckm4$cluster
ck4$centers<-ckm4$centers
ck4$size<-ckm4$size
ck4$iter<-ckm4$iters
p1 <- fviz_cluster(ck4, geom = "point",  data = as.data.frame(tsne_model_1_m4$Y))
bmp("tsne_model1_m4_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m5
bmp("tsne_model1_m5_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_1_m5$Y), col = ckm5$cluster)
dev.off()
ck5$cluster<-ckm5$cluster
ck5$centers<-ckm5$centers
ck5$size<-ckm5$size
ck5$iter<-ckm5$iters
p1 <- fviz_cluster(ck5, geom = "point",  data = as.data.frame(tsne_model_1_m5$Y))
bmp("tsne_model1_m5_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m6
bmp("tsne_model1_m6_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_1_m6$Y), col = ckm6$cluster)
dev.off()
ck6$cluster<-ckm6$cluster
ck6$centers<-ckm6$centers
ck6$size<-ckm6$size
ck6$iter<-ckm6$iters
p1 <- fviz_cluster(ck6, geom = "point",  data = as.data.frame(tsne_model_1_m6$Y))
bmp("tsne_model1_m6_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m7
bmp("tsne_model1_m7_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_1_m7$Y), col = ckm7$cluster)
dev.off()
ck7$cluster<-ckm7$cluster
ck7$centers<-ckm7$centers
ck7$size<-ckm7$size
ck7$iter<-ckm7$iters
p1 <- fviz_cluster(ck7, geom = "point",  data = as.data.frame(tsne_model_1_m7$Y))
bmp("tsne_model1_m7_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m8
bmp("tsne_model1_m8_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_1_m8$Y), col = ckm8$cluster)
dev.off()
ck8$cluster<-ckm8$cluster
ck8$centers<-ckm8$centers
ck8$size<-ckm8$size
ck8$iter<-ckm8$iters
p1 <- fviz_cluster(ck8, geom = "point",  data = as.data.frame(tsne_model_1_m8$Y))
bmp("tsne_model1_m8_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
#  m9
bmp("tsne_model1_m9_kmeans.bmp", width = 1980, height = 1280)
plot(as.data.frame(tsne_model_1_m9$Y), col = ckm9$cluster)
dev.off()
ck9$cluster<-ckm9$cluster
ck9$centers<-ckm9$centers
ck9$size<-ckm9$size
ck9$iter<-ckm9$iters
p1 <- fviz_cluster(ck9, geom = "point",  data = as.data.frame(tsne_model_1_m9$Y))
bmp("tsne_model1_m9_kmeans_ch.bmp", width = 1980, height = 1280)
grid.arrange(p1, ncol = 1, nrow = 1)
dev.off()
library(igraph) #  centralities
library(centiserve) #  centralities
library(factoextra)  # fviz_cluster()
library(Rtsne) #  TSNE
library(Plasmidprofiler) #  normalize()
library(data.table) #  transpose()
library(corrplot) #  correlation plot
library(gridExtra) #  multiplot
library(CINNA) #  centralities
library(Rdimtools) #  sammon's map
library(fpc) #  calinhara()
library(clusternor) # skmeans
