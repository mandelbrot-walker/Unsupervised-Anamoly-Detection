q()
library(igraph)
library(centiserve)
library(tidyverse)
library(data.table)
library(tibble)
library(gridExtra)
edges<-read.delim("Email-EuAll.txt",header = TRUE, sep = "\t")
g<-graph.data.frame(edges) #  graph data frame for igraph
setwd("C:/Users/ZahinAhmed/Desktop/StatisticalRankTest/Generated ego")
edges<-read.delim("Email-EuAll.txt",header = TRUE, sep = "\t")
g<-graph.data.frame(edges) #  graph data frame for igraph
edges<-read.delim("Email-EuAll.txt",header = TRUE, sep = "\t")
g<-graph.data.frame(edges) #  graph data frame for igraph
ncentrality2<-read.csv("NCentrality_Email_EuAll.csv") # read dataset of centralities
#---for rowsum highest----#
ncentrality2_rowsum_withnode<-cbind(ncentrality2, row_sum = rowSums(ncentrality2[-1]))
ncentrality2_rowsum_withnode<-ncentrality2_rowsum_withnode[order(-ncentrality2_rowsum_withnode$row_sum),]
source_node<- first(ncentrality2_rowsum_withnode$X)
x=30000 #number of nodes
f1 <- function(graph, data, extra) {
data['rank'] == x
}
bfs_highest_rowsum_source  <- bfs(g, root=source_node, "all", order=TRUE, callback = f1) #run bfs
sub_highest_rowsum_source <-bfs_highest_rowsum_sourcek$order[1:x]
newgraph_highest_rowsum_source = induced.subgraph(g, sub_highest_rowsum_source) #generate igraph of subgraph
bmp("ego_Plot_highest_rowsum-source_.bmp", width = 1920, height = 1080) #insert x value
plot(newgraph_highest_rowsum_source, main=" ego network of highest row sum source node nearby ... nodes") #insert x value
dev.off()
sub_highest_rowsum_source <-bfs_highest_rowsum_source$order[1:x]
newgraph_highest_rowsum_source = induced.subgraph(g, sub_highest_rowsum_source) #generate igraph of subgraph
bmp("ego_Plot_highest_rowsum-source_.bmp", width = 1920, height = 1080) #insert x value
plot(newgraph_highest_rowsum_source, main=" ego network of highest row sum source node nearby ... nodes") #insert x value
dev.off()
